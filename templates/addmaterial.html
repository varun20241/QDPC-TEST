<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
        <meta name="description" content="POS - Bootstrap Admin Template">
		<meta name="keywords" content="admin, estimates, bootstrap, business, corporate, creative, invoice, html5, responsive, Projects">
        <meta name="author" content="Dreamguys - Bootstrap Admin Template">
        <meta name="robots" content="noindex, nofollow">
		
        <title>Dreams Pos admin template</title>
		{% load static %}
		<!-- Favicon -->
        <!-- Favicon -->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

		<link rel="shortcut icon" type="image/x-icon" href="{% static 'assets/img/favicon.png' %}">
		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="{% static 'assets/css/bootstrap.min.css' %}">
		
		<!-- animation CSS -->
		<link rel="stylesheet" href="{% static 'assets/css/animate.css' %}">

		<!-- Datatable CSS -->
		<link rel="stylesheet" href="{% static 'assets/css/dataTables.bootstrap4.min.css' %}">
		
		<!-- Fontawesome CSS -->
		<link rel="stylesheet" href="{% static 'assets/plugins/fontawesome/css/fontawesome.min.css' %}">
		<link rel="stylesheet" href="{% static 'assets/plugins/fontawesome/css/all.min.css' %}">
		
		<!-- Main CSS -->
		<link rel="stylesheet" href="{% static 'assets/css/style2.css' %}">

		
    </head>
    <body>
		
		<div id="global-loader" >
			<div class="whirly-loader"> </div>
		</div>
		 
		<!-- Main Wrapper -->
        <div class="main-wrapper">
			
			 <!-- Header -->
			 <div class="header">
			
			 <!-- Logo -->
             <div class="header-left active">
                <a href="index.html" class="logo logo-normal">
                    <img src="{% static 'assets/img/esth.png"  alt="">
                </a>
                <a href="index.html" class="logo logo-white">
                    <img src="{% static 'assets/img/logo-white.png"  alt="">
                </a>
                <a href="index.html" class="logo-small">
                    <img src="{% static 'assets/img/logo-small.png"  alt="">
                </a>
                <a id="toggle_btn" href="javascript:void(0);">
                    <i data-feather="chevrons-left" class="feather-16"></i>
                </a>
            </div>
            <!-- /Logo -->
				
				<a id="mobile_btn" class="mobile_btn" href="#sidebar">
					<span class="bar-icon">
						<span></span>
						<span></span>
						<span></span>
					</span>
				</a>
				
				<!-- Header Menu -->
				<ul class="nav user-menu">
				
					<!-- Search -->
					<li class="nav-item nav-searchinputs">
						<div class="top-nav-search">
							
							<a href="javascript:void(0);" class="responsive-search">
								<i class="fa fa-search"></i>
							</a>
							<form action="#">
								<div class="searchinputs">
									<input type="text" placeholder="Search">
									<div class="search-addon">
										<span><i data-feather="search" class="feather-14"></i></span>
									</div>
								</div>
								<!-- <a class="btn"  id="searchdiv"><img src="assets/img/icons/search.svg" alt="img"></a> -->
							</form>
						</div>
					</li>
					<!-- /Search -->
				
					<!-- Flag -->
					<li class="nav-item dropdown has-arrow flag-nav nav-item-box">
						<a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="javascript:void(0);" role="button">
							<i data-feather="globe"></i>
						</a>
						<div class="dropdown-menu dropdown-menu-right">
							<a href="javascript:void(0);" class="dropdown-item active">
								<img src="{% static 'assets/img/flags/us.png' %}" alt="" height="16"> English
							</a>
							<a href="javascript:void(0);" class="dropdown-item">
								<img src="{% static 'assets/img/flags/fr.png' %}" alt="" height="16"> French
							</a>
							<a href="javascript:void(0);" class="dropdown-item">
								<img src="{% static 'assets/img/flags/es.png' %}" alt="" height="16"> Spanish
							</a>
							<a href="javascript:void(0);" class="dropdown-item">
								<img src="{% static 'assets/img/flags/de.png' %}" alt="" height="16"> German
							</a>
						</div>
					</li>
					<!-- /Flag -->

					<li class="nav-item nav-item-box">
						<a href="javascript:void(0);" id="btnFullscreen">
							<i data-feather="maximize"></i>
						</a>
					</li>
					<li class="nav-item nav-item-box">
						<a href="email.html">
							<i data-feather="mail"></i>
							<span class="badge rounded-pill">1</span>
						</a>
					</li>
					<!-- Notifications -->
					<li class="nav-item dropdown nav-item-box">
						<a href="javascript:void(0);" class="dropdown-toggle nav-link" data-bs-toggle="dropdown">
							<i data-feather="bell"></i><span class="badge rounded-pill">2</span>
						</a>
						<div class="dropdown-menu notifications">
							<div class="topnav-dropdown-header">
								<span class="notification-title">Notifications</span>
								<a href="javascript:void(0)" class="clear-noti"> Clear All </a>
							</div>
							<div class="noti-content">
								<ul class="notification-list">
									<li class="notification-message">
										<a href="activities.html">
											<div class="media d-flex">
												<span class="avatar flex-shrink-0">
													<img alt="" src="{% static 'assets/img/profiles/avatar-02.jpg' %}">
												</span>
												<div class="media-body flex-grow-1">
													<p class="noti-details"><span class="noti-title">John Doe</span> added new task <span class="noti-title">Patient appointment booking</span></p>
													<p class="noti-time"><span class="notification-time">4 mins ago</span></p>
												</div>
											</div>
										</a>
									</li>
									<li class="notification-message">
										<a href="activities.html">
											<div class="media d-flex">
												<span class="avatar flex-shrink-0">
													<img alt="" src="{% static 'assets/img/profiles/avatar-03.jpg' %}">
												</span>
												<div class="media-body flex-grow-1">
													<p class="noti-details"><span class="noti-title">Tarah Shropshire</span> changed the task name <span class="noti-title">Appointment booking with payment gateway</span></p>
													<p class="noti-time"><span class="notification-time">6 mins ago</span></p>
												</div>
											</div>
										</a>
									</li>
									<li class="notification-message">
										<a href="activities.html">
											<div class="media d-flex">
												<span class="avatar flex-shrink-0">
													<img alt="" src="{% static 'assets/img/profiles/avatar-06.jpg' %}">
												</span>
												<div class="media-body flex-grow-1">
													<p class="noti-details"><span class="noti-title">Misty Tison</span> added <span class="noti-title">Domenic Houston</span> and <span class="noti-title">Claire Mapes</span> to project <span class="noti-title">Doctor available module</span></p>
													<p class="noti-time"><span class="notification-time">8 mins ago</span></p>
												</div>
											</div>
										</a>
									</li>
									<li class="notification-message">
										<a href="activities.html">
											<div class="media d-flex">
												<span class="avatar flex-shrink-0">
													<img alt="" src="{% static 'assets/img/profiles/avatar-17.jpg' %}">
												</span>
												<div class="media-body flex-grow-1">
													<p class="noti-details"><span class="noti-title">Rolland Webber</span> completed task <span class="noti-title">Patient and Doctor video conferencing</span></p>
													<p class="noti-time"><span class="notification-time">12 mins ago</span></p>
												</div>
											</div>
										</a>
									</li>
									<li class="notification-message">
										<a href="activities.html">
											<div class="media d-flex">
												<span class="avatar flex-shrink-0">
													<img alt="" src="{% static 'assets/img/profiles/avatar-13.jpg' %}">
												</span>
												<div class="media-body flex-grow-1">
													<p class="noti-details"><span class="noti-title">Bernardo Galaviz</span> added new task <span class="noti-title">Private chat module</span></p>
													<p class="noti-time"><span class="notification-time">2 days ago</span></p>
												</div>
											</div>
										</a>
									</li>
								</ul>
							</div>
							<div class="topnav-dropdown-footer">
								<a href="activities.html">View all Notifications</a>
							</div>
						</div>
					</li>
					<!-- /Notifications -->
					
					<li class="nav-item nav-item-box">
						<a href="generalsettings.html"><i data-feather="settings"></i></a>
					</li>
					<li class="nav-item dropdown has-arrow main-drop">
						<a href="javascript:void(0);" class="dropdown-toggle nav-link userset" data-bs-toggle="dropdown">
							<span class="user-info">
								<span class="user-letter">
									<img src="{% static 'assets/img/profiles/avator1.jpg' %}" alt="" class="img-fluid">
								</span>
								<span class="user-detail">
									<span class="user-name">John Smilga</span>
									<span class="user-role">Super Admin</span>
								</span>
							</span>
						</a>
						<div class="dropdown-menu menu-drop-user">
							<div class="profilename">
								<div class="profileset">
									<span class="user-img"><img src="{% static 'assets/img/profiles/avator1.jpg' %}" alt="">
									<span class="status online"></span></span>
									<div class="profilesets">
										<h6>John Smilga</h6>
										<h5>Super Admin</h5>
									</div>
								</div>
								<hr class="m-0">
								<a class="dropdown-item" href="profile.html"> <i class="me-2"  data-feather="user"></i> My Profile</a>
								<a class="dropdown-item" href="generalsettings.html"><i class="me-2" data-feather="settings"></i>Settings</a>
								<hr class="m-0">
								<a class="dropdown-item logout pb-0" href="signin.html"><img src="{% static 'assets/img/icons/log-out.svg' %}" class="me-2" alt="img">Logout</a>
							</div>
						</div>
					</li>
				</ul>
				<!-- /Header Menu -->
				
				<!-- Mobile Menu -->
				<div class="dropdown mobile-user-menu">
					<a href="javascript:void(0);" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>
					<div class="dropdown-menu dropdown-menu-right">
						<a class="dropdown-item" href="profile.html">My Profile</a>
						<a class="dropdown-item" href="generalsettings.html">Settings</a>
						<a class="dropdown-item" href="signin.html">Logout</a>
					</div>
				</div>
				<!-- /Mobile Menu -->
			</div>
			<!-- Header -->
			
			<!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-inner slimscroll">
                    <div id="sidebar-menu" class="sidebar-menu">
                        <ul>
                            
                            <li class="submenu-open">
                                <h6 class="submenu-hdr">User Management</h6>
                                <ul>
                                    <li>
                                        <a href="dashboard.html" ><i data-feather="grid"></i><span>Dashboard</span></a>
                                    </li>
                                    <li>
                                        <a href="usernew.html" ><i data-feather="grid"></i><span>UserList</span></a>
                                    </li>
                                    <li>
                                        <a href="product.html" ><i data-feather="grid"></i><span>Product</span></a>
                                    </li>
									<li>
                                        <a href="{% url 'raw-material' %}" ><i data-feather="grid"></i><span>Material List</span></a>
                                    </li>
                                    <li>
                                        <a href="{% url 'raw-material-batch-fetch' %}" ><i data-feather="grid"></i><span>Rawmaterial batch</span></a>
                                    </li>
                                    <li>
                                        <a href="{% url 'raw-material-acceptance-list' %}" ><i data-feather="grid"></i><span>RM-Acceptance Test</span></a>
                                    </li>
                                    
                                </ul>								
                            </li>
                            
                            
                           
                        </ul>
                    </div>
                </div>
            </div>
            <!-- /Sidebar -->

			<div class="page-wrapper">
				<div class="content">
					<div class="page-header">
						<div class="page-title">
							<h4>Raw Material Add</h4> 
						</div>
					</div>
					<!-- /add -->
					<div class="card">
						<div class="card-body">
							<div class="row">
								<div class="col-lg-3 col-sm-6 col-12">
									<div class="form-group">
										<label>Raw Material</label>
										<input type="text" name="raw-material" id="raw-material">
									</div>
								</div>
								<div class="col-lg-3 col-sm-6 col-12">
									<label for="supplier" class="form-label">Suppliers</label>
									<select class="form-select"  id="supplier" name="supplier">
										
										{% for sup in suppliers %}
												<option value="{{ sup.id }}">{{ sup.name }}</option>
											{% endfor %}
									</select>
								</div>
								<div class="col-lg-3 col-sm-6 col-12">
									<label for="sources" class="form-label">Sources</label>
									<select class="form-select" id="sources" name="sources">
										
										{% for sour in sources %}
										<option value="{{ sour.id }}">{{ sour.name }}</option>
									{% endfor %}
									</select>
								</div>
									<div class="col-lg-3 col-sm-6 col-12">
										<div class="form-group">
											<label>Grade</label>
											<input type="text" id="grade" name="grade">
										</div>
									</div>
									<div class="col-lg-3 col-sm-6 col-12">
										<div class="form-group">
											<label>Shelf Life</label>
											<input type="text" name="shelf_life_value" id="shelf_life_value">
											<!-- Error message placeholder -->
											<div id="shelf_life_error" class="text-danger" style="display:none;"></div>
										</div>
									</div>
									
									<div class="col-lg-3 col-sm-6 col-12">
										<div class="form-group">
											<label for="unit">Shelf Life Period</label>
											<select name="unit" id="unit" class="form-control">
												<option value="days">Days</option>
												<option value="months">Months</option>
											</select>
										</div>
									</div>
                               
									<div class="col-lg-3 col-sm-6 col-12">
										<div class="form-group">
											<label for="user_defined_date">User Defined Date</label>
											<input type="date" id="user_defined_date" name="user_defined_date" class="form-control">
										</div>
									</div>
							
								<div class="col-lg-12">
									<button type="button" id="submitButton" class="btn btn-submit me-2">Submit</button>
									<a href="productlist.html" class="btn btn-cancel">Clear</a>
								</div>
							</div>
						</div>
					</div>
					<!-- /add -->
				</div>
			</div>
        </div>
		<!-- /Main Wrapper -->
		 
		<script src="{% static 'assets/js/jquery-3.6.0.min.js' %}"></script>

        <!-- Feather Icon JS -->
        <script src="{% static 'assets/js/feather.min.js' %}"></script>

        <!-- Slimscroll JS -->
        <script src="{% static 'assets/js/jquery.slimscroll.min.js' %}"></script>

        <!-- Datatable JS -->
        <script src="{% static 'assets/js/jquery.dataTables.min.js' %}"></script>
        <script src="{% static 'assets/js/dataTables.bootstrap4.min.js' %}"></script>
        
        <!-- Bootstrap Core JS -->
        <script src="{% static 'assets/js/bootstrap.bundle.min.js' %}"></script>

        <!-- Sweetalert 2 -->
        <script src="{% static 'assets/plugins/sweetalert/sweetalert2.all.min.js' %}"></script>
        <script src="{% static 'assets/plugins/sweetalert/sweetalerts.min.js' %}"></script>

        <!-- Chart JS -->
        <script src="{% static 'assets/plugins/apexchart/apexcharts.min.js' %}"></script>
        <script src="{% static 'assets/plugins/apexchart/chart-data.js' %}"></script>
        
        <!-- Custom JS -->
        <script src="{% static 'assets/js/script.js' %}"></script>

		
    </body>

	<script>
        $(document).ready(function() {
            $('#submitButton').click(function(event) {
                event.preventDefault(); 
              // Check if this alert shows

                // Gather form data
                var name = $('#raw-material').val();
                var grade = $('#grade').val();
                var shelf_life_value = parseInt($('#shelf_life_value').val(), 10); // Ensure integer conversion
                var shelf_life_unit = $('#unit').val();
                var user_defined_date = $('#user_defined_date').val();
                
                // Get selected values from dropdowns
				var sources = $('#sources').val() ? [Number($('#sources').val())] : []; // Single value handled as array
				var suppliers = $('#supplier').val() ? [Number($('#supplier').val())] : [];
				if (isNaN(shelf_life_value) || shelf_life_value <= 0) {
					$('#shelf_life_error').text("Shelf life must be a positive numeric value.").show();
					return; // Stop form submission if validation fails
				}

						// Create the data object
                var rawMaterialData = {
                    name: name,
                    grade: grade,
                    shelf_life_value: shelf_life_value,
                    shelf_life_unit: shelf_life_unit,
                    user_defined_date: user_defined_date,
                    sources: sources,
                    suppliers: suppliers
                };
              // Debug: Check the data object

                // Send data as JSON
                $.ajax({
                    type: 'POST',
                    url: '{% url "raw-material-add" %}', // URL to your Django view
                    data: JSON.stringify(rawMaterialData),
                    contentType: 'application/json',
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}' // CSRF token for security
                    },
                    success: function(response) {
					
                        if (response.success) {
                            window.location.href = "{% url 'raw-material' %}";
                        } else {
                            $('#error-message').text(response.message).show(); // Show error message
                        }
                    },
                    error: function() {
                        $('#error-message').text('An error occurred. Please try again.').show(); // Show error message
                    }
                });
            });
        });
    </script>
</html>